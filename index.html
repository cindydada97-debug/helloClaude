<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="HappyPuppy.ai - 个人工具站，提供编程、效率、图像、办公、游戏等多种实用工具">
    <meta name="keywords" content="工具站,在线工具,编程工具,效率工具,图像工具">
    <meta name="author" content="HappyPuppy.ai Team">

    <title>HappyPuppy.ai - 个人工具站</title>

    <!-- Favicon (待替换) -->
    <link rel="icon" href="./assets/logo/favicon.ico">

    <!-- 外部CDN预连接 -->
    <link rel="preconnect" href="https://cdn.tailwindcss.com">
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+SC:wght@300;400;500;700;900&display=swap" rel="stylesheet">

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-primary': '#0A0A0F',
                        'dark-secondary': '#131318',
                    },
                    fontFamily: {
                        'sans': ['Noto Sans SC', 'Inter', 'system-ui'],
                    },
                    screens: {
                        '2xl': '1920px',
                        '3xl': '2560px',
                    }
                }
            }
        }
    </script>

    <!-- 模块样式 - 使用相对路径 -->
    <link rel="stylesheet" href="./modules/navigation/navigation.css">
    <link rel="stylesheet" href="./modules/hero/hero.css">
    <link rel="stylesheet" href="./modules/tool-card/tool-card.css">
    <link rel="stylesheet" href="./modules/search-results/search-results.css">
    <link rel="stylesheet" href="./modules/footer/footer.css">

    <!-- 全局样式 -->
    <style>
        * {
            font-family: 'Noto Sans SC', 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0A0A0F 0%, #131318 100%);
            min-height: 100vh;
            margin: 0;
            padding: 0;
            color: #FFFFFF;
        }

        /* 平滑滚动 */
        html {
            scroll-behavior: smooth;
        }

        /* 自定义滚动条 */
        ::-webkit-scrollbar {
            width: 10px;
            height: 10px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.02);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        /* 加载动画 */
        .app-loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: #0A0A0F;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            opacity: 1;
            transition: opacity 0.3s ease;
        }

        .app-loading.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: #3B82F6;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            color: rgba(255, 255, 255, 0.6);
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
    </style>
</head>
<body>
    <!-- 加载动画 -->
    <div class="app-loading" id="app-loading">
        <div class="spinner"></div>
        <p class="loading-text">Loading modules...</p>
    </div>

    <!-- 导航栏容器 -->
    <div id="navigation-container"></div>

    <!-- 主内容区 -->
    <main>
        <!-- 英雄区容器 -->
        <div id="hero-container"></div>

        <!-- 搜索结果容器 -->
        <div id="search-results-container"></div>
    </main>

    <!-- 页脚容器 -->
    <div id="footer-container"></div>

    <!-- 工具卡片模板容器 -->
    <div id="tool-card-template-container"></div>

    <!-- 全局脚本 - 按顺序加载 -->
    <script src="./scripts/config.js"></script>
    <script src="./scripts/utils.js"></script>
    <script src="./scripts/template-loader.js"></script>

    <!-- 初始化脚本 -->
    <script>
        /**
         * 模板加载器 - 内联版本（确保定义）
         */
        class TemplateLoader {
            constructor() {
                this.templates = new Map();
                this.loadedCount = 0;
                this.totalCount = 0;
            }

            async loadTemplate(url, containerId) {
                try {
                    console.log(`Loading template: ${url}`);
                    const response = await fetch(url);
                    if (!response.ok) {
                        throw new Error(`Failed to load ${url}: ${response.status}`);
                    }

                    const html = await response.text();
                    const container = document.getElementById(containerId);

                    if (!container) {
                        throw new Error(`Container #${containerId} not found`);
                    }

                    container.innerHTML = html;
                    this.templates.set(containerId, html);
                    this.loadedCount++;

                    console.log(`✓ Loaded: ${url}`);
                    return true;
                } catch (error) {
                    console.error(`✗ Error loading template from ${url}:`, error);
                    return false;
                }
            }

            async loadTemplates(templateConfigs) {
                this.totalCount = templateConfigs.length;
                this.loadedCount = 0;

                const promises = templateConfigs.map(config =>
                    this.loadTemplate(config.url, config.containerId)
                );

                return Promise.all(promises);
            }

            getProgress() {
                return {
                    loaded: this.loadedCount,
                    total: this.totalCount,
                    percentage: this.totalCount > 0 ? (this.loadedCount / this.totalCount) * 100 : 0
                };
            }
        }

        /**
         * 应用初始化
         */
        (async function initApp() {
            try {
                console.log('🚀 Starting HappyPuppy.ai initialization...');

                // 1. 创建模板加载器
                const loader = new TemplateLoader();

                // 2. 定义模板配置 - 使用相对路径
                const templates = [
                    {
                        url: './modules/navigation/navigation.html',
                        containerId: 'navigation-container'
                    },
                    {
                        url: './modules/hero/hero.html',
                        containerId: 'hero-container'
                    },
                    {
                        url: './modules/search-results/search-results.html',
                        containerId: 'search-results-container'
                    },
                    {
                        url: './modules/footer/footer.html',
                        containerId: 'footer-container'
                    },
                    {
                        url: './modules/tool-card/tool-card.html',
                        containerId: 'tool-card-template-container'
                    }
                ];

                // 3. 加载所有模板
                console.log('📄 Loading templates...');
                const results = await loader.loadTemplates(templates);

                const allLoaded = results.every(result => result === true);
                if (!allLoaded) {
                    console.warn('⚠️  Some templates failed to load');
                    const failed = results.reduce((acc, result, index) => {
                        if (!result) acc.push(templates[index].url);
                        return acc;
                    }, []);
                    console.error('Failed templates:', failed);
                }

                console.log('✓ Templates loaded successfully');

                // 4. 动态加载模块脚本
                console.log('📦 Loading module scripts...');
                await loadModuleScripts();

                console.log('✓ Module scripts loaded');

                // 5. 等待一小段时间确保所有模块初始化
                await new Promise(resolve => setTimeout(resolve, 200));

                // 6. 隐藏加载动画
                hideLoading();

                console.log('✅ HappyPuppy.ai initialized successfully!');

            } catch (error) {
                console.error('❌ Failed to initialize app:', error);
                hideLoading();
                showError('应用加载失败，请刷新页面重试');
            }
        })();

        /**
         * 动态加载模块脚本
         */
        async function loadModuleScripts() {
            const scripts = [
                './modules/navigation/navigation.js',
                './modules/hero/hero.js',
                './modules/tool-card/tool-card.js',
                './modules/search-results/search-results.js',
                './modules/footer/footer.js',
                './scripts/main.js'
            ];

            // 按顺序加载脚本
            for (const src of scripts) {
                try {
                    await loadScript(src);
                } catch (error) {
                    console.error(`Failed to load script: ${src}`, error);
                    // 继续加载其他脚本
                }
            }
        }

        /**
         * 加载单个脚本
         */
        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = () => {
                    console.log(`  ✓ Loaded: ${src}`);
                    resolve();
                };
                script.onerror = () => {
                    console.error(`  ✗ Failed to load: ${src}`);
                    reject(new Error(`Failed to load script: ${src}`));
                };
                document.body.appendChild(script);
            });
        }

        /**
         * 隐藏加载动画
         */
        function hideLoading() {
            const loading = document.getElementById('app-loading');
            if (loading) {
                loading.classList.add('hidden');
                setTimeout(() => {
                    loading.remove();
                }, 300);
            }
        }

        /**
         * 显示错误信息
         */
        function showError(message) {
            const loading = document.getElementById('app-loading');
            if (loading) {
                loading.innerHTML = `
                    <div style="text-align: center; padding: 2rem;">
                        <i class="fa-solid fa-exclamation-triangle" style="font-size: 3rem; color: #EF4444; margin-bottom: 1rem;"></i>
                        <p style="color: #FFFFFF; font-size: 1.125rem; margin-bottom: 0.5rem; font-weight: 700;">${message}</p>
                        <p style="color: rgba(255,255,255,0.6); font-size: 0.875rem; margin-bottom: 1.5rem;">请检查浏览器控制台获取详细错误信息</p>
                        <button onclick="location.reload()" style="margin-top: 1rem; padding: 0.75rem 1.5rem; background: #3B82F6; color: white; border: none; border-radius: 8px; cursor: pointer; font-weight: 500;">
                            <i class="fa-solid fa-rotate-right" style="margin-right: 0.5rem;"></i>
                            刷新页面
                        </button>
                    </div>
                `;
            }
        }
    </script>
</body>
</html>
